<?xml version="1.0" encoding="UTF-8"?>
<refentry id="ad.1">
  <refmeta>
    <refentrytitle>ad</refentrytitle>

    <manvolnum>1</manvolnum>

    <refmiscinfo class="date">02 Sep 2011</refmiscinfo>

    <refmiscinfo class="source">@NETATALK_VERSION@</refmiscinfo>
  </refmeta>

  <refnamediv>
    <refname>ad</refname>

    <refpurpose>Netatalk互換UNIXファイルユーティリティ 一式</refpurpose>
  </refnamediv>

  <refsynopsisdiv>
    <cmdsynopsis>
      <command>ad</command>

      <arg choice="req">ls | cp | mv | rm</arg>

      <arg>...</arg>
    </cmdsynopsis>

    <cmdsynopsis>
      <command>ad</command>

      <arg choice="req">-v | --version</arg>
    </cmdsynopsis>
  </refsynopsisdiv>

  <refsect1>
    <title>説明</title>

    <para><command>ad</command>は、Netatalk互換のUNIXファイルユーティリティ一式である。<filename>.AppleDouble</filename>ディレクトリのAppleDouble<indexterm>
        <primary>AppleDouble</primary>
      </indexterm>ファイルとCNIDデータベースを適切に更新する。(訳注: 説明が古い。AppleDoubleファイルは.AppleDoubleディレクトリとは限らないし、拡張属性に保存する場合もある。)</para>
  </refsect1>

  <refsect1>
    <title>有効なコマンド</title>

    <cmdsynopsis>
      <command>ad ls</command>

      <arg>-dRl<arg>u</arg></arg>

      <arg choice="req">file|dir <arg>...</arg></arg>
    </cmdsynopsis>

    <para>ファイルやディレクトリをリストする。</para>

    <cmdsynopsis>
      <command>ad cp</command>

      <arg choice="opt">-aipvf</arg>

      <arg choice="req">src_file</arg>

      <arg choice="req">dst_file</arg>
    </cmdsynopsis>

    <cmdsynopsis>
      <command>ad cp -R</command>

      <arg choice="opt">-aipvf</arg>

      <arg choice="req">src_file|src_directory ...</arg>

      <arg choice="req">dst_directory</arg>
    </cmdsynopsis>

    <para>ファイルやディレクトリをコピーする。</para>

    <cmdsynopsis>
      <command>ad mv</command>

      <arg choice="opt">-finv</arg>

      <arg choice="req">src_file</arg>

      <arg choice="req">dst_file</arg>
    </cmdsynopsis>

    <cmdsynopsis>
      <command>ad mv</command>

      <arg choice="opt">-finv</arg>

      <arg choice="req">src_file|src_directory ...</arg>

      <arg choice="req">dst_directory</arg>
    </cmdsynopsis>

    <para>ファイルやディレクトリを移動する。</para>

    <cmdsynopsis>
      <command>ad rm</command>

      <arg choice="opt">-Rv</arg>

      <arg choice="req">file|directory</arg>
    </cmdsynopsis>

    <cmdsynopsis>
      <command>ad -v|--version</command>
    </cmdsynopsis>

    <para>バージョンを表示する。</para>
  </refsect1>

  <refsect1>
    <title>ad ls</title>

    <para>ファイルやディレクトリをリストする。 オプション:</para>

    <variablelist>
      <varlistentry>
        <term>-d</term>

        <listitem>
          <para>ディレクトリを単純なファイルとしてリストする</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>-R</term>

        <listitem>
          <para>サブディレクトリを再帰的にリストする</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>-l</term>

        <listitem>
          <para>長い出力。AFP infoをリストする</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>-u</term>

        <listitem>
          <para>UNIX infoをリストする</para>
        </listitem>
      </varlistentry>
    </variablelist>

    <para><emphasis>長い出力の説明</emphasis></para>

    <programlisting>&lt;unixinfo&gt; &lt;FinderFlags&gt; &lt;AFP Attributes&gt; &lt;Color&gt; &lt;Type&gt; &lt;Creator&gt; &lt;CNID from AppleDouble&gt; &lt;name&gt;

FinderFlags (valid for (f)iles and/or (d)irectories):

  d = On Desktop                      (f/d)
  e = Hidden extension                (f/d)
  m = Shared (can run multiple times) (f)
  n = No INIT resources               (f)
  i = Inited                          (f/d)
  c = Custom icon                     (f/d)
  t = Stationery                      (f)
  s = Name locked                     (f/d)
  b = Bundle                          (f/d)
  v = Invisible                       (f/d)
  a = Alias file                      (f/d)

AFP Attributes:

  y = System                          (f/d)
  w = No write                        (f)
  p = Needs backup                    (f/d)
  r = No rename                       (f/d)
  l = No delete                       (f/d)
  o = No copy                         (f)

Note: any letter appearing in uppercase means the flag is set but it's a directory for which the flag is not allowed.</programlisting>
  </refsect1>

  <refsect1>
    <title>ad cp</title>

    <para>ファイルやディレクトリをコピーする。</para>

    <para>上の概要で示した一番目の形式では、cpユーティリティはsrc_fileの内容をdst_fileへコピーする。二番目の形式では、それぞれの名前のsrc_fileの内容は配布先のdst_directoryにコピーされる。ファイル自身の名前は変更されない。ファイルを自分自身へコピーしようとしているのをcpが検出したら、コピーは失敗する。</para>

    <para>ボリュームルートに".AppleDesktop"ディレクトリがあることで、Netatlak AFPボリュームであることが検出される。(訳注: この説明は古い。現在は別の方法で検出する。) AFPボリュームへのコピーであると検出された場合、CNIDデータベースデーモンに接続し、全てのコピーはCNIDデータベースの手続きを踏む。ターゲットがAFPボリュームの場合はAppleDoubleファイルもまたコピーされ、必要なら作成される。(訳注: この説明も古い。メタデータはAppleDoubleファイルとは限らず、拡張属性に入っている場合もある。)</para>

    <para>オプション:</para>

    <variablelist>
      <varlistentry>
        <term>-a</term>

        <listitem>
          <para>アーカイブモード。-Rpと同じ。</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>-f</term>

        <listitem>
          <para>それぞれの配布先パス名が既に存在している場合、それを削除してから新しいファイルを作成する。パーミッションに関わらず確認プロンプトを出しません。(-fオプションは手前の-iオプションと-nオプションを無効にします。)</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>-i</term>

        <listitem>
          <para>存在するファイルに上書きする前に、標準エラー出力にプロンプトを出す。もし標準入力からの返答が'y'または'Y'ならばファイルコピーを試みる。(-iオプションは手前の-fオプションと-nオプションを無効にします。)</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>-n</term>

        <listitem>
          <para>存在するファイルを上書きしない。 (-nオプションは手前の-fオプションと-iオプションを無効にします。)</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>-p</term>

        <listitem>
          <para>以下に示すそれぞれのコピー元ファイルの属性を、パーミッションが許す限り維持する: 変更時刻、アクセス時刻、ファイルフラグ、ファイルモード、ユーザIDグループID。ユーザIDとグループIDが維持されない場合、エラーメッセージは表示されず、終了コードは変更されない。</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>-R</term>

        <listitem>
          <para>もしsrc_fileでディレクトリを指定した場合、cpはそのディレクトリと全体のサブツリーをコピーする。もしsrc_fileが「/」で終わっている場合、ディレクトリ自身ではなく中身をコピーする。</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>-v</term>

        <listitem>
          <para>コピーされたファイルを詳細に表示する。</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>-x</term>

        <listitem>
          <para>ファイルシステムのマウントポイントを横断しない。</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </refsect1>

  <refsect1>
    <title>ad mv</title>

    <para>Move files and directories.</para>

    <para>Move files around within an AFP volume, updating the CNID database
    as needed. If either:<itemizedlist>
        <listitem>
          <para>source or destination is not an AFP volume</para>
        </listitem>

        <listitem>
          <para>source AFP volume != destination AFP volume</para>
        </listitem>
      </itemizedlist>the files are copied and removed from the source.</para>

    <para>Options:</para>

    <variablelist>
      <varlistentry>
        <term>-f</term>

        <listitem>
          <para>Do not prompt for confirmation before overwriting the
          destination path. (The -f option overrides any previous -i or -n
          options.)</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>-i</term>

        <listitem>
          <para>Cause mv to write a prompt to standard error before moving a
          file that would overwrite an existing file. If the response from the
          standard input begins with the character `y' or `Y', the move is
          attempted. (The -i option overrides any previous -f or -n
          options.)</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>-n</term>

        <listitem>
          <para>Do not overwrite an existing file. (The -n option overrides
          any previous -f or -i options.)</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>-v</term>

        <listitem>
          <para>Cause mv to be verbose, showing files after they are
          moved.</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </refsect1>

  <refsect1>
    <title>ad rm</title>

    <para>Remove files and directories.</para>

    <para>The rm utility attempts to remove the non-directory type files
    specified on the command line. If the files and directories reside on an
    AFP volume, the corresponding CNIDs are deleted from the volumes
    database.</para>

    <para>The options are as follows:</para>

    <variablelist>
      <varlistentry>
        <term>-R</term>

        <listitem>
          <para>Attempt to remove the file hierarchy rooted in each file
          argument.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>-v</term>

        <listitem>
          <para>Be verbose when deleting files, showing them as they are
          removed.</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </refsect1>

  <refsect1>
    <title>Reporting Bugs</title>

    <para>Report bugs to the Netatalk-devel list
    &lt;netatalk-devel@lists.sourceforge.net&gt;.</para>
  </refsect1>

  <refsect1>
    <title>See also</title>

    <para><citerefentry>
        <refentrytitle>dbd</refentrytitle>

        <manvolnum>1</manvolnum>
      </citerefentry>, <citerefentry>
        <refentrytitle>apple_dump</refentrytitle>

        <manvolnum>1</manvolnum>
      </citerefentry>.</para>
  </refsect1>
</refentry>
